<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chương 1 Tính toán phí bảo hiểm bằng mô hình tuyến tính tổng quát. | bookdown-demo.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chương 1 Tính toán phí bảo hiểm bằng mô hình tuyến tính tổng quát. | bookdown-demo.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chương 1 Tính toán phí bảo hiểm bằng mô hình tuyến tính tổng quát. | bookdown-demo.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">KHDL KT&KD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="10-Ung-dung-GLM.html"><a href="#tính-toán-phí-bảo-hiểm-bằng-mô-hình-tuyến-tính-tổng-quát."><i class="fa fa-check"></i><b>1</b> Tính toán phí bảo hiểm bằng mô hình tuyến tính tổng quát.</a>
<ul>
<li class="chapter" data-level="1.1" data-path="10-Ung-dung-GLM.html"><a href="#dữ-liệu-để-xây-dựng-mô-hình"><i class="fa fa-check"></i><b>1.1</b> Dữ liệu để xây dựng mô hình</a></li>
<li class="chapter" data-level="1.2" data-path="10-Ung-dung-GLM.html"><a href="#phân-tích-khai-phá-dữ-liệu"><i class="fa fa-check"></i><b>1.2</b> Phân tích khai phá dữ liệu</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="10-Ung-dung-GLM.html"><a href="#biến-tần-suất-và-mối-liên-hệ-đến-các-biến-khác"><i class="fa fa-check"></i><b>1.2.1</b> Biến tần suất và mối liên hệ đến các biến khác</a></li>
<li class="chapter" data-level="1.2.2" data-path="10-Ung-dung-GLM.html"><a href="#biến-mức-độ-nghiêm-trọng-và-mối-liên-hệ-với-các-biến-khác"><i class="fa fa-check"></i><b>1.2.2</b> Biến mức độ nghiêm trọng và mối liên hệ với các biến khác</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="10-Ung-dung-GLM.html"><a href="#mô-hình-tuyến-tính-tổng-quát-cho-tần-suất."><i class="fa fa-check"></i><b>1.3</b> Mô hình tuyến tính tổng quát cho tần suất.</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="10-Ung-dung-GLM.html"><a href="#mô-hình-tuyến-tính-tổng-quát-với-một-biến-giải-thích."><i class="fa fa-check"></i><b>1.3.1</b> Mô hình tuyến tính tổng quát với một biến giải thích.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="10-Ung-dung-GLM.html"><a href="#xây-dựng-mô-hình-tuyến-tính-tổng-quát-nhiều-biến"><i class="fa fa-check"></i><b>1.4</b> Xây dựng mô hình tuyến tính tổng quát nhiều biến</a></li>
<li class="chapter" data-level="1.5" data-path="10-Ung-dung-GLM.html"><a href="#mô-hình-tuyến-tính-tổng-quát-cho-biến-mức-độ-nghiêm-trọng."><i class="fa fa-check"></i><b>1.5</b> Mô hình tuyến tính tổng quát cho biến mức độ nghiêm trọng.</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="10-Ung-dung-GLM.html"><a href="#mô-hình-đơn-biến-cho-mức-độ-nghiêm-trọng"><i class="fa fa-check"></i><b>1.5.1</b> Mô hình đơn biến cho mức độ nghiêm trọng</a></li>
<li class="chapter" data-level="1.5.2" data-path="10-Ung-dung-GLM.html"><a href="#mô-hình-nhiều-biến-cho-mức-độ-nghiêm-trọng"><i class="fa fa-check"></i><b>1.5.2</b> Mô hình nhiều biến cho mức độ nghiêm trọng</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="10-Ung-dung-GLM.html"><a href="#xác-định-phí-bảo-hiểm-thuần-và-xác-thực-mô-hình"><i class="fa fa-check"></i><b>1.6</b> Xác định phí bảo hiểm thuần và xác thực mô hình</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="tính-toán-phí-bảo-hiểm-bằng-mô-hình-tuyến-tính-tổng-quát." class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chương 1</span> Tính toán phí bảo hiểm bằng mô hình tuyến tính tổng quát.<a href="#tính-toán-phí-bảo-hiểm-bằng-mô-hình-tuyến-tính-tổng-quát." class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Tính toán phí của các sản phẩm bảo hiểm là một công việc phức tạp đòi hỏi phải kết hợp nhiều yếu tố khác nhau. Trước hết dữ liệu lịch sử phải được phân tích chính xác, các xu hướng kinh tế xã hội cũng phải được xác định và thậm chí hoạt động của các công ty cạnh tranh cũng phải được tính đến. Các chuyên gia tính toán (Actuary) được đào tạo bài bản có kiến thức trong tất cả các lĩnh vực này và có khả năng đề xuất những nội dung cần thiết để phát triển và thực hiện thành công chiến lược định giá sản phẩm bảo hiểm. Trong phần này, chúng tôi sẽ minh họa quá trình tính toán ra một trong những nền tảng cơ bản nhất của một quá trình định giá, đó là xác định phí bảo hiểm thuần (Net premium). Chúng tôi xác định các khoản phí bảo hiểm thuần này dựa trên các mô hình tuyến tính tổng quát về tần suất và mức độ nghiêm trọng. Quá trình xây dựng mô hình sẽ được minh họa thông qua tất cả các giai đoạn: xác định đặc điểm dữ liệu, khai phá dữ liệu, phân tích một chiều và đa chiều, kết hợp tần suất và mức độ nghiêm trọng thành phí bảo hiểm thuần và cuối cùng là xác thực mô hình. Các kỹ thuật mà chúng tôi minh họa có thể áp dụng rộng rãi và chúng tôi khuyến khích bạn đọc tích cực thực hành thông qua các đoạn câu lệnh được viết bằng phần mềm R.</p>
<p>Các chuyên gia tính toán phân tích dữ liệu lịch sử và giải thích các xu hướng kinh tế xã hội để xác định mức giá hợp lý của sản phẩm bảo hiểm. Những tính toán của Actuary là nền tảng cho mức giá cuối cùng mà công ty đưa ra cho khách hàng của mình. Đưa ra mức giá cuối cùng phải kết hợp nhiều cân nhắc, chẳng hạn như hành động của đối thủ cạnh tranh, chiến lược tăng trưởng và sự hài lòng của người tiêu dùng… Do đó, các chuyên gia tính toán, các nhà bảo lãnh phát hành, nhóm tiếp thị phân phối sản phẩm, nhóm tiếp nhận yêu cầu bồi thường và ban quản lý công ty phải cùng nhau hợp tác trong việc định giá. Các đối tượng đa dạng này phải hiểu rõ ràng các hướng tiếp cận để định giá và ý nghĩa của các quyết định liên quan.</p>
<p>Trong các phần này của cuốn sách, chúng ta sẽ tập trung vào các giai đoạn đầu tiên của quá trình hình thành giá của sản phẩm bào hiểm đó là “Xây dựng mô hình” và “Xác thực và cải tiến mô hình”. Kết quả của các quá trình này là tính toán ra phí bảo hiểm thuần dựa trên dữ liệu lịch sử và mô hình tuyến tính tổng quát. Sẽ có hai mô hình được xây dựng, một mô hình dành cho tần suất xảy ra sự kiện bảo hiểm và mô hình còn lại sẽ có mục tiêu là mức độ nghiêm trọng. Vì phí bảo hiểm thuần chỉ phản ánh dữ liệu lịch sử nên sẽ không phù hợp để sử dụng làm dự báo giá cho tương lai do không tính toán đến các xu hướng kinh tế xã hội trong khoảng thời gian tiếp theo. Phí bảo hiểm thuần cũng không tính toán đến các chi phí, chi phí vốn rủi ro, hay lợi nhuận biên cần thiết để giúp công ty tồn tại trên thị trường.</p>
<p>Chương sách này được cấu trúc như sau: trong phần xxxx, chúng tôi mô tả các đặc điểm tổng thể chính của tập dữ liệu chúng tôi có sẵn được coi là dữ liệu lịch sử được sử dụng làm cơ sở xây dựng mô hình; trong phần xxxxxxx , chúng tôi bắt đầu khai phá các biến của tập dữ liệu. Đây là tập dữ liệu về bào hiểm đối với các xe ô tô chở khách tư có nhiều đặc điểm điển hình mà bạn sẽ gặp phải mỗi khi làm việc với dữ liệu bảo hiểm. Những hiểu biết về dữ liệu bạn thu được khi khai phá dữ liệu về các biến riêng và mối quan hệ giữa các biến sẽ phục vụ tốt cho bạn trong giai đoạn xây dựng mô hình. Trong Phần 1.4 và 1.5, chúng tôi bắt đầu xây dựng các mô hình: tần suất và mức độ nghiêm trọng tương ứng. Chúng tôi minh họa một số kỹ thuật được áp dụng rộng rãi. Chúng tôi bắt đầu với phân tích một chiều và chuyển sang phân tích đa chiều. Những mô hình chúng tôi xây dựng không nhất thiết phải là những mô hình tốt nhất và chúng tôi khuyến khích người đọc khám phá và cố gắng tạo ra những mô hình tốt hơn. Phân tích dữ liệu không phải là một môn thể thao dành cho khán giả. Người đọc phải tích cực tham gia! Để đạt được mục đích này, chúng tôi đã rải nhiều bài tập xuyên suốt văn bản. Hầu hết các bài tập đều yêu cầu các phép tính được thực hiện tốt nhất trong môi trường cung cấp một tập hợp phong phú các chức năng thống kê và thao tác dữ liệu. Bài tập 1.1. Chuẩn bị môi trường máy tính của bạn. Tải xuống tập dữ liệu được phân cách bằng dấu phẩy sim-modeling-dataset.csv và tải nó vào môi trường của bạn. Tất cả các bài tập đều có lời giải (chúng tôi đã sử dụng môi trường R nguồn mở để minh họa các phép tính cần thiết), nhưng người đọc sẽ được hưởng lợi nhiều nhất khi chỉ xem xét các lời giải sau khi thử một cách trung thực lời giải của chúng. Phần 1.6 kết hợp các mô hình tần suất và mức độ nghiêm trọng để tạo ra phí bảo hiểm thuần túy và Phần 1.7 trình bày một số kỹ thuật xác thực đơn giản trên một phần dữ liệu mà mô hình của chúng tôi chưa từng thấy. Điều quan trọng là nỗ lực lập mô hình của chúng tôi không phóng đại tính chính xác hoặc hiệu suất của các mô hình mà chúng tôi tạo ra. Với sức mạnh tính toán sẵn có ngày nay và các thuật toán phức tạp, thật dễ dàng để chuyển một số mô hình sang dữ liệu. Một mô hình overft có xu hướng trông rất đẹp, nhưng khi đối mặt với dữ liệu mới, dự đoán của nó lại tệ hơn nhiều. Cuối cùng, Phần 1.8 có một số nhận xét kết luận.</p>
<div id="dữ-liệu-để-xây-dựng-mô-hình" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Dữ liệu để xây dựng mô hình<a href="#dữ-liệu-để-xây-dựng-mô-hình" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tập dữ liệu mô hình “modeling-dataset.csv” được sử dụng để là dữ liệu lịch sử các chuyên gia tính toán xây dựng mô hình tuyến tính tổng quát. Bộ dữ liệu bao gồm thông tin về các hợp đồng bảo hiểm ô tô chở khách thương mại và thông tin về yêu cầu bồi thường. Dữ liệu được quan sát trong các năm từ 2010 đến 2013. Có tổng cộng 40.760 hàng và 24 biến.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>dat<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">&quot;C:/Users/AD/Desktop/Tex file/Thu latex/Book demo/bookdown_demo_hieu/Dataset/pricing-modeling-dataset.csv&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>## # A tibble: 40,760 × 24
##    pol.id    year exposure nb.rb driver.age driver.gender marital.status
##    &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;         
##  1 POL0001   2010   1      RB            63 Male          Married       
##  2 POL0002   2010   1      NB            33 Male          Married       
##  3 POL0003   2010   1      RB            68 Male          Married       
##  4 POL0004   2010   0.0833 RB            68 Male          Married       
##  5 POL0005   2010   1      RB            68 Male          Married       
##  6 POL0006   2010   0.0833 RB            68 Male          Married       
##  7 POL0007   2011   1      RB            53 Male          Married       
##  8 POL0008   2010   1      RB            68 Male          Married       
##  9 POL0009   2011   0.0833 RB            68 Male          Married       
## 10 POL00010  2010   1      RB            65 Male          Married       
## # ℹ 40,750 more rows
## # ℹ 17 more variables: yrs.licensed &lt;dbl&gt;, ncd.level &lt;dbl&gt;, region &lt;dbl&gt;,
## #   body.code &lt;chr&gt;, vehicle.age &lt;dbl&gt;, vehicle.value &lt;dbl&gt;, seats &lt;dbl&gt;,
## #   ccm &lt;dbl&gt;, hp &lt;dbl&gt;, weight &lt;dbl&gt;, length &lt;dbl&gt;, width &lt;dbl&gt;, height &lt;dbl&gt;,
## #   fuel.type &lt;chr&gt;, prior.claims &lt;dbl&gt;, clm.count &lt;dbl&gt;, clm.incurred &lt;dbl&gt;</code></pre>
<p>Cần lưu ý là một hàng dữ liệu có thể thể hiện nhiều yêu cầu bồi thường từ một người được bảo hiểm. Biến <span class="math inline">\(clm.count\)</span> đo lường số lượng yêu cầu bồi thường và biến <span class="math inline">\(clm.incurred\)</span> là tổng số tiền thanh toán yêu cầu bồi thường riêng lẻ và bao gồm cả các khoản cần phải thanh toán trong tương lai. Các biến độc lập của có thể được nhóm thành bốn loại: biến điều khiển, biến đặc điểm người lái, biến đặc điểm địa lý, và biến đặc điểm phương tiện. Bảng dưới đây cho biết tên các biến trong tập dữ liệu</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-4">Table 1.1: </span>Các biến trong dữ liệu lịch sử
</caption>
<thead>
<tr>
<th style="text-align:left;">
Biến mục tiêu
</th>
<th style="text-align:left;">
Biến điều khiển
</th>
<th style="text-align:left;">
Đặc điểm người lái
</th>
<th style="text-align:left;">
Đặc điểm phương tiện
</th>
<th style="text-align:left;">
Đặc điểm địa lý
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
clm.count
</td>
<td style="text-align:left;">
pol.id
</td>
<td style="text-align:left;">
nb.rb
</td>
<td style="text-align:left;">
body.code
</td>
<td style="text-align:left;">
region
</td>
</tr>
<tr>
<td style="text-align:left;">
clm.incurred
</td>
<td style="text-align:left;">
year
</td>
<td style="text-align:left;">
driver.age
</td>
<td style="text-align:left;">
vehicle.age
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
exposure
</td>
<td style="text-align:left;">
driver.gender
</td>
<td style="text-align:left;">
vehicle.value
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
marital.status
</td>
<td style="text-align:left;">
seats
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
yrs.licensed
</td>
<td style="text-align:left;">
ccm
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
ncd.level
</td>
<td style="text-align:left;">
hp
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
prior.claims
</td>
<td style="text-align:left;">
weight
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
length
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
width
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
height
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
fuel.type
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>Biến <span class="math inline">\(year\)</span> cho biết năm (dương lịch) mà xe được bảo hiểm và biến <span class="math inline">\(exposure\)</span> đo lường khoảng thời gian theo năm mà xe ô tô được bảo vệ trong năm dương lịch. Chúng ta chỉ có một biến địa lý la <span class="math inline">\(region\)</span> cho chúng ta biết địa điểm (gara) của xe. Điều đáng tiếc là biến <span class="math inline">\(region\)</span> đã được mã hóa thành số và chúng ta không có bất kỳ thông tin nào về mối liên hệ về mặt không gian của các vùng này. Đây là một nhược điểm đáng kể đối với tập dữ liệu mà chúng ta có. Xin được nhắc lại rằng việc chuẩn bị dữ liệu tốt trước khi xây dựng mô hình là rất quan trọng nên loại bỏ biến chỉ thực hiện khi chúng ta chắc chắn rằng biến không có chứa thông tin hữu ích.</p>
<p>Các biến đặc tính của người lái xe bao gồm độ tuổi (<span class="math inline">\(driver.age\)</span>), giới tính (<span class="math inline">\(driver.gender\)</span>) của người điều khiển phương tiện, tình trạng hôn nhân (<span class="math inline">\(marital.status\)</span>), số năm mà người điều khiển phương tiện đã được cấp phép (<span class="math inline">\(yrs.licensed\)</span>), mức chiết khấu khi không yêu cầu bồi thường <span class="math inline">\(ncd.level\)</span> (giá trị cao hơn phản ánh mức chiết khấu lớn hơn khi không có bất kỳ yêu cầu nào) và số lượng yêu cầu gửi trước đó. Biến <span class="math inline">\(nb.rb\)</span> cho chúng ta biết hợp đồng này là hoạt động kinh doanh mới (nb) hay hoạt động kinh doanh tái tục (rb).</p>
<p>Các biến đặc tính của xe đo lường các thuộc tính khác nhau như kiểu dáng thân xe (<span class="math inline">\(body.code\)</span>); tuổi và giá trị của xe (<span class="math inline">\(vehicle.age\)</span> và <span class="math inline">\(vehicle.value\)</span>); số lượng chỗ ngồi (<span class="math inline">\(seats\)</span>); và trọng lượng (<span class="math inline">\(weight\)</span>), chiều dài (<span class="math inline">\(length\)</span>), chiều rộng (<span class="math inline">\(width\)</span>) và chiều cao (<span class="math inline">\(height\)</span>) của xe. Các biến <span class="math inline">\(ccm\)</span>, <span class="math inline">\(hp\)</span> và <span class="math inline">\(fuel.type\)</span> lần lượt đo kích thước của động cơ theo xăng-ti-mét khối, mã lực và loại nhiên liệu (xăng, dầu diesel hoặc khí hóa lỏng).</p>
<p>Như đã giới thiệu ở trên, hai biến mục tiêu là <span class="math inline">\(clm.count\)</span> và <span class="math inline">\(clm.incurred\)</span>, cho biết số lần gửi yêu cầu bồi thường và tổng chi phí cuối cùng của những yêu cầu đó. Tất cả các biến trong tập dữ liệu đều có thể được phân loại là liên tục hoặc rời rạc. Bảng xxxxxx trình bày một số chỉ số thống kê cho 14 biến liên tục và Bảng xxxxxx trình bày một số thông tin về 12 biến rời rạc.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-5">Table 1.2: </span>Các biến kiểu số
</caption>
<thead>
<tr>
<th style="text-align:right;">
Tên biến
</th>
<th style="text-align:right;">
Trung bình
</th>
<th style="text-align:right;">
Phương sai
</th>
<th style="text-align:right;">
Giá trị min
</th>
<th style="text-align:right;">
Giá trị max
</th>
<th style="text-align:right;">
Trung vị
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
exposure
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
<tr>
<td style="text-align:right;">
driver.age
</td>
<td style="text-align:right;">
44.55
</td>
<td style="text-align:right;">
10.78
</td>
<td style="text-align:right;">
18.00
</td>
<td style="text-align:right;">
93.00
</td>
<td style="text-align:right;">
44.00
</td>
</tr>
<tr>
<td style="text-align:right;">
yrs.licensed
</td>
<td style="text-align:right;">
3.21
</td>
<td style="text-align:right;">
1.89
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
10.00
</td>
<td style="text-align:right;">
3.00
</td>
</tr>
<tr>
<td style="text-align:right;">
vehicle.age
</td>
<td style="text-align:right;">
3.26
</td>
<td style="text-align:right;">
2.59
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
18.00
</td>
<td style="text-align:right;">
3.00
</td>
</tr>
<tr>
<td style="text-align:right;">
vehicle.value
</td>
<td style="text-align:right;">
23.50
</td>
<td style="text-align:right;">
8.89
</td>
<td style="text-align:right;">
4.50
</td>
<td style="text-align:right;">
132.60
</td>
<td style="text-align:right;">
22.10
</td>
</tr>
<tr>
<td style="text-align:right;">
ccm
</td>
<td style="text-align:right;">
1670.69
</td>
<td style="text-align:right;">
390.12
</td>
<td style="text-align:right;">
970.00
</td>
<td style="text-align:right;">
3198.00
</td>
<td style="text-align:right;">
1560.00
</td>
</tr>
<tr>
<td style="text-align:right;">
hp
</td>
<td style="text-align:right;">
86.38
</td>
<td style="text-align:right;">
19.62
</td>
<td style="text-align:right;">
42.00
</td>
<td style="text-align:right;">
200.00
</td>
<td style="text-align:right;">
75.00
</td>
</tr>
<tr>
<td style="text-align:right;">
weight
</td>
<td style="text-align:right;">
1364.22
</td>
<td style="text-align:right;">
222.01
</td>
<td style="text-align:right;">
860.00
</td>
<td style="text-align:right;">
2275.00
</td>
<td style="text-align:right;">
1320.00
</td>
</tr>
<tr>
<td style="text-align:right;">
length
</td>
<td style="text-align:right;">
4.32
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
1.80
</td>
<td style="text-align:right;">
6.94
</td>
<td style="text-align:right;">
4.28
</td>
</tr>
<tr>
<td style="text-align:right;">
width
</td>
<td style="text-align:right;">
1.78
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
1.48
</td>
<td style="text-align:right;">
2.12
</td>
<td style="text-align:right;">
1.74
</td>
</tr>
<tr>
<td style="text-align:right;">
height
</td>
<td style="text-align:right;">
1.81
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
2.52
</td>
<td style="text-align:right;">
1.82
</td>
</tr>
<tr>
<td style="text-align:right;">
prior.claims
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
1.33
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
20.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
clm.count
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
clm.incurred
</td>
<td style="text-align:right;">
66.52
</td>
<td style="text-align:right;">
406.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
11683.58
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-6">Table 1.3: </span>Các biến kiểu rời rạc
</caption>
<thead>
<tr>
<th style="text-align:right;">
Tên biến
</th>
<th style="text-align:right;">
Số giá trị rời rạc
</th>
<th style="text-align:right;">
Giá trị mode
</th>
<th style="text-align:right;">
Các giá trị điển hình
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
year
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
2010,2011,2012,2013
</td>
</tr>
<tr>
<td style="text-align:right;">
nb.rb
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NB
</td>
<td style="text-align:right;">
NB,RB
</td>
</tr>
<tr>
<td style="text-align:right;">
driver.gender
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
Male
</td>
<td style="text-align:right;">
Female,Male
</td>
</tr>
<tr>
<td style="text-align:right;">
marital.status
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
Married
</td>
<td style="text-align:right;">
Divorced,Married,Single,Widow
</td>
</tr>
<tr>
<td style="text-align:right;">
ncd.level
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1,2,3,4,5
</td>
</tr>
<tr>
<td style="text-align:right;">
region
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
1,2,3,4,5
</td>
</tr>
<tr>
<td style="text-align:right;">
body.code
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
A
</td>
<td style="text-align:right;">
A,B,C,D,E
</td>
</tr>
<tr>
<td style="text-align:right;">
seats
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
2,3,4,5,6
</td>
</tr>
<tr>
<td style="text-align:right;">
fuel.type
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
Diesel
</td>
<td style="text-align:right;">
Diesel,Gasoline,LPG
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-7">Table 1.4: </span>Tần suất và mức độ nghiêm trọng trung bình theo năm
</caption>
<thead>
<tr>
<th style="text-align:right;">
Năm
</th>
<th style="text-align:right;">
Exposure
</th>
<th style="text-align:right;">
Số yêu cầu
</th>
<th style="text-align:right;">
Tổng giá trị
</th>
<th style="text-align:right;">
Tần suất
</th>
<th style="text-align:right;">
Mức độ nghiêm trọng
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
3661.9
</td>
<td style="text-align:right;">
422
</td>
<td style="text-align:right;">
287868.9
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:right;">
78.612
</td>
</tr>
<tr>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
5221.7
</td>
<td style="text-align:right;">
551
</td>
<td style="text-align:right;">
314430.6
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
60.216
</td>
</tr>
<tr>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
6527.2
</td>
<td style="text-align:right;">
1278
</td>
<td style="text-align:right;">
1021151.8
</td>
<td style="text-align:right;">
0.196
</td>
<td style="text-align:right;">
156.446
</td>
</tr>
<tr>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
5386.2
</td>
<td style="text-align:right;">
1180
</td>
<td style="text-align:right;">
1087735.2
</td>
<td style="text-align:right;">
0.219
</td>
<td style="text-align:right;">
201.949
</td>
</tr>
<tr>
<td style="text-align:right;">
Total
</td>
<td style="text-align:right;">
20797.1
</td>
<td style="text-align:right;">
3431
</td>
<td style="text-align:right;">
2711186.6
</td>
<td style="text-align:right;">
0.165
</td>
<td style="text-align:right;">
130.364
</td>
</tr>
</tbody>
</table>
<p>Thống kê chung về tần suất và mức độ nghiêm trọng theo năm được cho trong Bảng xxxxxx. Lưu ý rằng khối lượng kinh doanh đã tăng khoảng 78% từ năm 2010 đến năm 2012 và sau đó giảm 17% vào năm 2013. Tần suất trong hai năm đầu tiên là khoảng 11% và sau đó tăng đáng kể lên khoảng 20%. Mức độ nghiêm trọng trung bình trong tất cả các năm dương lịch là 790, nhưng có mức tăng mạnh theo thời gian, ngoại trừ năm 2011.</p>
<p>Thông thường quá trình xây dựng và xác thực mô hình sẽ cần chia dữ liệu của thành ba phần: tập dữ liệu huấn luyện (training dataset), tập dữ liệu kiểm tra mô hình (test dataset) và tập dữ liệu xác thực mô hình (validation dataset). Lưu ý rằng việc phân chia dữ liệu thành ba phần chỉ khả thi khi có một lượng lớn dữ liệu. Trong trường hợp của dữ liệu ở trên, chúng ta chỉ có khoảng 41.000 quan sát trong bốn năm dương lịch. Đây là một tập dữ liệu không đủ lớn, vì vậy chúng tôi sẽ sử dụng phương pháp tập xác thực chéo. Thay vì chia dữ liệu thành ba tập, chúng ta sẽ chỉ chia dữ liệu thành hai tập: tập huấn luyện và tập xác thực. Tập dữ liệu huấn luyện để phát triển và thử nghiệm các mô hình chứa 70% dữ liệu. 30% dữ liệu được sử dụng để kiểm tra mô hình. Trong xác thực chéo, chúng tôi chia dữ liệu huấn luyện của mình thành năm tập hợp con (5-folds) và gắn nhãn cho các tập này từ 1 đến 5. Tham số cuối cùng của mô hình được sử dụng là giá trị trung bình của các tham số được ước lượng ra từ mỗi lần xác thực chéo.</p>
</div>
<div id="phân-tích-khai-phá-dữ-liệu" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Phân tích khai phá dữ liệu<a href="#phân-tích-khai-phá-dữ-liệu" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Trong phần này, chúng ta bắt đầu bằng cách khai phá các biến riêng lẻ để hiểu rõ hơn về thông tin có trong tập dữ liệu của mình. Trong quá trình phân tích dữ liệu, chúng ta sẽ tập trung vào việc tìm hiểu mức độ phổ biến của từng biến, loại giá trị mà mỗi biến nhận, cách mã hóa các giá trị còn thiếu và mối quan hệ qua lại giữa các biến.</p>
<div id="biến-tần-suất-và-mối-liên-hệ-đến-các-biến-khác" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Biến tần suất và mối liên hệ đến các biến khác<a href="#biến-tần-suất-và-mối-liên-hệ-đến-các-biến-khác" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Từ phần trước, chúng ta biết rằng tần suất chung của toàn bộ tập dữ liệu là 16,5%. Do chúng ta xây dựng mô hình dựa trên cách tiếp cận xác thực chéo nên dữ liệu xây dựng mô hình chỉ bao gồm 60% dữ liệu hiện có. Chúng ta chia dữ liệu một cách ngẫu nhiên như sau</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Đổi các biến rời rạc về kiểu factor</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>factor.variable<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;year&quot;</span>,<span class="st">&quot;nb.rb&quot;</span>,<span class="st">&quot;driver.gender&quot;</span>,<span class="st">&quot;marital.status&quot;</span>,<span class="st">&quot;ncd.level&quot;</span>,<span class="st">&quot;region&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>      <span class="st">&quot;body.code&quot;</span>,<span class="st">&quot;seats&quot;</span>,<span class="st">&quot;fuel.type&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>dat<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(dat)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dat)){</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">names</span>(dat)[i] <span class="sc">%in%</span> factor.variable){</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    dat[,i]<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dat[,i])</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  }</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>}</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co"># Chia dữ liệu thành hai phần, dữ liệu huấn luyện mô hình và dữ liệu xác thực mô hình</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>train.index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat),<span class="at">size =</span> <span class="fu">round</span>(<span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(dat),<span class="dv">0</span>),<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>training.dat<span class="ot">&lt;-</span>dat[train.index,]</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>test.dat<span class="ot">&lt;-</span>dat[<span class="sc">-</span>train.index,]</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co"># Tần suất trung bình trên tập dữ liệu huấn luyện</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="fu">sum</span>(training.dat<span class="sc">$</span>clm.count)<span class="sc">/</span><span class="fu">sum</span>(training.dat<span class="sc">$</span>exposure)</span></code></pre></div>
<pre><code>## [1] 0.1635727</code></pre>
<p>Trên tập dữ liệu huấn luyện, tần suất trung bình là 16,4% rất gần với tần suất chung ở phần trước. Quá trình khai phá dữ liệu là quá trình tìm hiểu biến tần suất phụ thuộc như thế nào vào các biến số mà chúng ta có trong dữ liệu. Hãy bắt đầu bằng cách xem xét biến <span class="math inline">\(nb.rb\)</span>. Đây là một biến chỉ báo cho chúng ta biết hợp đồng bảo hiểm là hoạt động khai thác mới (NB) hay là hợp đồng tái tục (RB). Tần suất trong tập dữ liệu huấn luyện của chúng tôi theo chỉ số khai thác mới hoặc tái tục này nằm trong Bảng xxxxx</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-9">Table 1.5: </span>Tần suất trung bình theo năm của hợp đồng khai thác mới và tái tục
</caption>
<thead>
<tr>
<th style="text-align:right;">
Năm
</th>
<th style="text-align:right;">
HĐ mới/Tái tục
</th>
<th style="text-align:right;">
Exposure
</th>
<th style="text-align:right;">
Số yêu cầu
</th>
<th style="text-align:right;">
Tần suất
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
NB
</td>
<td style="text-align:right;">
2477.3
</td>
<td style="text-align:right;">
306
</td>
<td style="text-align:right;">
0.124
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;">
RB
</td>
<td style="text-align:right;">
1184.6
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
0.098
</td>
</tr>
<tr>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
NB
</td>
<td style="text-align:right;">
3475.4
</td>
<td style="text-align:right;">
440
</td>
<td style="text-align:right;">
0.127
</td>
</tr>
<tr>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;">
RB
</td>
<td style="text-align:right;">
1746.3
</td>
<td style="text-align:right;">
111
</td>
<td style="text-align:right;">
0.064
</td>
</tr>
<tr>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
NB
</td>
<td style="text-align:right;">
4389.6
</td>
<td style="text-align:right;">
934
</td>
<td style="text-align:right;">
0.213
</td>
</tr>
<tr>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;">
RB
</td>
<td style="text-align:right;">
2137.7
</td>
<td style="text-align:right;">
344
</td>
<td style="text-align:right;">
0.161
</td>
</tr>
<tr>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
NB
</td>
<td style="text-align:right;">
3762.1
</td>
<td style="text-align:right;">
953
</td>
<td style="text-align:right;">
0.253
</td>
</tr>
<tr>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
RB
</td>
<td style="text-align:right;">
1624.1
</td>
<td style="text-align:right;">
227
</td>
<td style="text-align:right;">
0.140
</td>
</tr>
<tr>
<td style="text-align:right;">
Total
</td>
<td style="text-align:right;">
NB
</td>
<td style="text-align:right;">
14104.4
</td>
<td style="text-align:right;">
2633
</td>
<td style="text-align:right;">
0.187
</td>
</tr>
<tr>
<td style="text-align:right;">
Total
</td>
<td style="text-align:right;">
RB
</td>
<td style="text-align:right;">
6692.7
</td>
<td style="text-align:right;">
798
</td>
<td style="text-align:right;">
0.119
</td>
</tr>
</tbody>
</table>
<p>Có thể thấy rằng trong dữ liệu đào tạo, tần suất trung bình của với hợp đồng khai thác mới là 18,7% và của các hợp đồng tái tục là 11,9%. Đây là một sự khác biệt đáng kể, do đó biến <span class="math inline">\(rb.nb\)</span> này là một lựa chọn tốt để đưa vào mô hình.</p>
<p>Tiếp theo, chúng ta quan tâm đến biến vị trí địa lý <span class="math inline">\(region\)</span>. Mặc dù vị trí địa lý đã được mã hóa bằng các số tự nhiên từ 1 đến 38 và chúng ta không biết được vị trí thực sự của các vùng. Tuy nhiên, có sự phân bố không đồng đều về tần suất xảy ra tai nạn giữa các vùng địa lý theo thời gian. Thật vậy, hình vẽ dưới đây mô tả điều đó</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-10-1.png" width="1152" />
Có thể thấy rằng có sự khác nhau rõ rệt về tần suất xảy ra tai nạn giữa các vùng, và tần suất cũng có sự thay đổi theo thời gian. Do đó, không nên loại bỏ biến vùng ra khỏi dữ liệu xây dựng mô hình.</p>
<p>Tiếp theo chúng ta xem xét <span class="math inline">\(driver.age\)</span>. Biến này cho chúng ta biết tuổi của người điều khiển chính phương tiện. Trong dữ liệu huấn luyện mô hình, chúng ta có độ tuổi từ 18 đến 89 và tuổi 93(!), tổng cộng có 73 độ tuổi duy nhất. Khi gặp dữ liệu như vậy, chúng ta nên nghi ngờ những độ tuổi rất cao này và cần kiểm tra xem dữ liệu có chính xác không. Ngoài ra, chúng ta cũng nên kiểm tra tổng số exposure theo từng độ tuổi.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-11-1.png" width="1152" /></p>
<p>Có thể thấy rằng khi tổng số exposure nhỏ thì tần suất có biến động rất mạnh, điển hình là độ tuổi dưới 25 và trên 60. Độ tuổi có tần suất tai nạn cao nhất không được thể hiện trong đồ thị ở trên là tuổi 19 với tần suất là 182%, tuy nhiên tổng exposure cho độ tuổi này chỉ là 2,2 năm nên tần suất không có ý nghĩa thống kê. Nhìn chung có sự giảm dần của tần suất xảy ra tai nạn khi độ tuổi trung bình. Bạn đọc có thể quan sát thấy rằng đường thẳng mô tả mối quan hệ tuyến tính giữa tần suất và độ tuổi có độ dốc âm. Như vậy <span class="math inline">\(driver.age\)</span> cũng là biến cần đưa vào mô hình.</p>
<p>Các biến liên quan đến đặc điểm người lái xe còn có giới tính của người lái xe (<span class="math inline">\(driver.gender\)</span>) và tình trạng hôn nhân (<span class="math inline">\(marital.status\)</span>. Mối liên hệ của các biến và tần suất được mô tả như đồ thị dưới đây</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Có thể thấy rằng tần suất gây ra tai nạn của lái xe nữ là cao hơn so với lái xe nam, sự khác biệt là tương đối rõ trong nhóm những người đã lập gia đình hoặc chưa từng lập gia đình. Cũng giống như kinh nghiệm nghiên cứu từ nhiều dữ liệu khác, nhóm những người góa vợ/chồng có tần suất gây ra tai nạn cao hơn đáng kể so với nhóm khác. Có thể nhận xét rằng tình trạng hôn nhân và giới tính của người lái xe có ảnh hưởng đến tần suất mặc dù ảnh hưởng không rõ ràng như các biến khác.</p>
<p>Chúng ta có thể tiếp tục quá trình trên cho các biến khác liên quan đến người lái xe. Tuy nhiên, mục tiêu cuối cùng sẽ là xây dựng mô hình cho biến tần suất, do đó, bạn đọc có thể dựa trên các nguyên tắc ở trên để nghiên cứu mối liên hệ của các biến khác lên tần suất xảy ra tai nạn. Quá trình khai phá dữ liệu có ý nghĩa quan trọng trong việc lựa chọn đưa biến vào trong mô hình nhất là với các dữ liệu có nhiều biến. Bạn đọc có thể tiếp tục quá trình này với các biến liên quan đến đặc điểm của xe.</p>
</div>
<div id="biến-mức-độ-nghiêm-trọng-và-mối-liên-hệ-với-các-biến-khác" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Biến mức độ nghiêm trọng và mối liên hệ với các biến khác<a href="#biến-mức-độ-nghiêm-trọng-và-mối-liên-hệ-với-các-biến-khác" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dữ liệu sử dụng để xây dựng mô hình cho mức độ nghiêm trọng chỉ bao gồm các hợp đồng có xảy ra yêu cầu bồi thường. Trong dữ liệu dùng để huấn luyện mô hình, có 2209 hợp đồng nằm trong phạm vi. Giá trị tiền bồi thường trung bình trên mỗi yêu cầu bồi thường là 800,57
<span class="math display">\[\begin{align}
\cfrac{\textit{Tổng chi phí}}{\textit{Tổng số yêu cầu}} = \cfrac{1.906.958}{2382} = 800,57
\end{align}\]</span></p>
<p>Trước hết, chúng ta xem xét biến <span class="math inline">\(nb.rb\)</span> có tác động lên mức độ nghiêm trọng hay không. Bảng dưới đây cho biết số lượng yêu cầu bồi thường, tổng mức bồi thường và giá trị tiền bồi thường trung bình của các hợp đồng bán mới và các hợp đồng tái tục.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-13">Table 1.6: </span>Mức độ nghiêm trọng trung bình của hợp đồng khai thác mới và tái tục
</caption>
<thead>
<tr>
<th style="text-align:right;">
HĐ mới/Tái tục
</th>
<th style="text-align:right;">
Tổng giá trị
</th>
<th style="text-align:right;">
Số yêu cầu
</th>
<th style="text-align:right;">
Mức nghiêm trọng
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
NB
</td>
<td style="text-align:right;">
1530245.4
</td>
<td style="text-align:right;">
1848
</td>
<td style="text-align:right;">
828.055
</td>
</tr>
<tr>
<td style="text-align:right;">
RB
</td>
<td style="text-align:right;">
376712.6
</td>
<td style="text-align:right;">
534
</td>
<td style="text-align:right;">
705.454
</td>
</tr>
</tbody>
</table>
<p>Có thể thấy rằng mức độ nghiêm trọng trung bình của các hợp đồng khai thác mới (828) cao hơn đáng kể so với các hợp đồng tái tục (705). Điều này cho thấy biến <span class="math inline">\(nb.rb\)</span> là biến có ý nghĩa giải thích trong mô hình hóa mức độ nghiêm trọng của yêu cầu bảo hiểm.</p>
<p>Việc phân tích các biến liên quan đến đặc điểm của người lái xe hoàn toàn được thực hiện tương tự như đối với biến tần suất nên chúng tôi sẽ không lặp lại. Việc lựa chọn các biến đưa vào mô hình tần suất sẽ được tiếp tục thảo luận trong phần xây dựng mô hình.</p>
</div>
</div>
<div id="mô-hình-tuyến-tính-tổng-quát-cho-tần-suất." class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Mô hình tuyến tính tổng quát cho tần suất.<a href="#mô-hình-tuyến-tính-tổng-quát-cho-tần-suất." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Khi phân tích khai phá dữ liêu, chúng ta biết rằng biến tần suất tập dữ liệu huấn luyện có giá trị trung bình là 16,4% và có một số biến có thể là phù hợp để đưa vào mô hình bao gồm tuổi của người lái xe hoặc chỉ số cho biết hợp đồng là bán mới hay tái tục. Chúng ta sẽ bắt đầu xây dựng mô hình tần số bằng cách thực hiện phân tích mô hình có một biến độc lập duy nhất, sau đó sẽ chuyển sang xây dựng mô hình có nhiều biến độc lập bằng cách bổ sung thêm các biến có ý nghĩa khác. Xây dựng mô hình có một biến độc lập là bước quan trọng để chúng ta có nhận định chính xác về khả năng giải thích của các biến độc lập và cách biến đổi các biến độc lập để tăng khả năng giải thích trước khi xây dựng mô hình có nhiều biến độc lập</p>
<p>Trước khi nói đến biến độc lập, chúng ta cần đưa ra lựa chọn cho hàm liên kết và phân phối cho biến tần suất. Đối với hầu hết các mô hình tính toán phí bảo hiểm thuần, chúng ta muốn có biến phụ thuộc được giải thích bởi biến phụ thuộc thông qua quy tắc nhân, do đó chúng ta sẽ sử dụng hàm liên kết <span class="math inline">\(log()\)</span>. Đối với phân phối biến phụ thuộc, chúng ta có thể chọn giữa phân phối Poisson, phân phối nhị thức âm hoặc phân phối nhị thức do biến tần suất là biến dạng đếm. Hãy nhớ rằng mục tiêu của chúng ta là ước tính tần suất trung bình và mặc dù các giả thiết về phân phối là cần thiết nhưng không quan trọng bằng việc tìm ra các biến độc lập chính xác để đưa vào mô hình.</p>
<p>Nếu phân phối xác suất của số lượng yêu cầu bồi thường là Poisson thì phương sai của biến phụ thuộc phải bằng giá trị trung bình. Tuy nhiên, trong trường hợp dữ liệu chúng ta đang có, và trong hầu hết các tập dữ liệu bảo hiểm, phương sai của tần suất thường lớn hơn giá trị trung bình. Hiện tượng này được gọi là phân tán quá mức. Bạn đọc nên lựa chọn phân phối nhị thức âm trong các trường hợp như vậy. Tuy nhiên, phân phối nhị thức âm không nằm trong nhóm các phân phối kiểu mũ nên để tránh sự phức tạp không cần thiết, chúng tôi vẫn chọn phân phối Poisson cho biến phụ thuộc. Hàm liên kết được sử dụng là hàm log.</p>
<div id="mô-hình-tuyến-tính-tổng-quát-với-một-biến-giải-thích." class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Mô hình tuyến tính tổng quát với một biến giải thích.<a href="#mô-hình-tuyến-tính-tổng-quát-với-một-biến-giải-thích." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mô hình tuyến tính tổng quát đơn giản nhất mà chúng ta có thể áp dụng cho dữ liệu tần suất là mô hình chỉ có duy nhất hệ số chặn. Mô hình này sẽ cho biết tần suất trung bình của biến phụ thuộc. Chúng ta xây dựng mô hình với biến phụ thuộc có phân phối Poisson, với hàm liên kết log, và chỉ có hệ số chặn như sau</p>
<pre><code>## 
## Call:
## glm(formula = clm.count ~ 1, family = poisson(link = &quot;log&quot;), 
##     data = training.dat, offset = log(exposure))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.5720  -0.4953  -0.3692  -0.2335   4.5865  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.81050    0.02049  -88.36   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 11573  on 28531  degrees of freedom
## Residual deviance: 11573  on 28531  degrees of freedom
## AIC: 16097
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Giá trị ước lượng được của hệ số chặn là <span class="math inline">\(-1.8105\)</span> và giá trị này khác 0 một cách có ý nghĩa thống kê. Mô hình tuyến tính tổng quát trong trường hợp này có thể được viết như sau:
<span class="math display">\[\begin{align}
&amp; Y_i \sim \mathcal{P}(\lambda_i) \\
&amp; \log(\lambda_i) = \log(e_i) + \beta_0
\end{align}\]</span>
trong đó <span class="math inline">\(e_i\)</span> là giá trị của biến <span class="math inline">\(exposure\)</span> của hợp đồng thứ <span class="math inline">\(i\)</span>. Nói cách khác, nếu hợp đồng được quan sát đủ 1 năm (<span class="math inline">\(e_i = 1\)</span>) thì giá trị trung bình của tần suất xảy ra tai nạn là
<span class="math display">\[\begin{align}
\lambda_i = \exp\left(\log(1) + \beta_0\right) = \exp(-1.8105) = 0.164
\end{align}\]</span>
Giá trị này rất gần với giá trị trung bình của biến tần suất mà chúng ta đã tính trong phần phân tích khai phá dữ liệu.</p>
<p>Để xây dựng mô hình có một biến phụ thuộc, chúng ta sẽ sử dụng các tiêu chí để so sánh mô hình được để cập trong chương mô hình tuyến tính tổng quát, bao gồm có thước đo <span class="math inline">\(deviance\)</span> và chỉ tiêu AIC. Nhắc lại rằng thước đo <span class="math inline">\(deviance\)</span> đo khoảng cách từ giá trị log-likelihood của một mô hình tuyến tính tổng quát đến giá trị log-likelihood lớn nhất có thể có được khi sử dụng cùng một phân phối của biến phụ thuộc trong khi AIC là được tính từ giá trị của hàm log-likelihood có điều chỉnh theo số lượng tham số. Mô hình tuyến tính tổng quát có thước đo <span class="math inline">\(deviance\)</span> và chỉ tiêu AIC nhỏ hơn là các mô hình phù hợp hơn với dữ liệu.</p>
<p>Trước khi xây dựng mô hình, bạn đọc cần lưu ý về biến độc lập kiểu số và biến độc lập kiểu factor. Biến <span class="math inline">\(year\)</span> trong mô hình đang được coi là biến kiểu factor với 4 giá trị khác nhau là 2010, 2011, 2012, và 2014, nghĩa là khi chúng ta sử dụng <span class="math inline">\(year\)</span> như một biến độc lập trong mô hình, sẽ có 4 tham số độc lập được ước lượng dành cho biến <span class="math inline">\(year\)</span>, mỗi tham số đại diện cho 1 giá trị. Nếu chúng ta coi biến <span class="math inline">\(year\)</span> như một biến kiểu số, khi xây dựng mô hình sẽ chỉ có một tham số ứng với biến <span class="math inline">\(year\)</span> và thêm 1 hệ số chặn. Với một số biến trong mô hình, chúng ta vừa có thể coi biến đó là kiểu số và vừa có thể coi biến đó là biến kiểu rời rạc. Danh sách các biến nằm trong bảng dưới đây</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-15">Table 1.7: </span>Các biến vừa có thể là biến kiểu số vừa là rời rạc
</caption>
<thead>
<tr>
<th style="text-align:right;">
Tên biến
</th>
<th style="text-align:right;">
Số giá trị riêng biệt
</th>
<th style="text-align:right;">
Miền giá trị
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
yrs.licensed
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
Các số tự nhiên từ 1 đến 9
</td>
</tr>
<tr>
<td style="text-align:right;">
vehicle.age
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
Các số tự nhiên từ 0 đến 18
</td>
</tr>
<tr>
<td style="text-align:right;">
prior.claims
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
Các số tự nhiên từ 0 đến 20
</td>
</tr>
</tbody>
</table>
<p>Đối với các biến này, chúng ta sẽ lưu trong dữ liệu huấn luyện mô hình đồng thời dưới dạng số (tên biến có <span class="math inline">\(.num\)</span> và dưới dạng factor (tên biến có <span class="math inline">\(.f\)</span>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>training.dat<span class="ot">&lt;-</span>training.dat<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">yrs.licensed.num =</span> yrs.licensed,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                                    <span class="at">vehicle.age.num =</span> vehicle.age,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                                    <span class="at">prior.claims.num =</span> prior.claims,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                                    <span class="at">yrs.licensed.f =</span> <span class="fu">as.factor</span>(yrs.licensed),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                                    <span class="at">vehicle.age.f =</span> <span class="fu">as.factor</span>(vehicle.age),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                                    <span class="at">prior.claims.f =</span> <span class="fu">as.factor</span>(prior.claims)) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>yrs.licensed,<span class="sc">-</span>vehicle.age,<span class="sc">-</span>prior.claims)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co"># thực hiện biến đổi tương tự trên tập xác thực</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>test.dat<span class="ot">&lt;-</span>test.dat<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">yrs.licensed.num =</span> yrs.licensed,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>                                    <span class="at">vehicle.age.num =</span> vehicle.age,</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>                                    <span class="at">prior.claims.num =</span> prior.claims,</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>                                    <span class="at">yrs.licensed.f =</span> <span class="fu">as.factor</span>(yrs.licensed),</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>                                    <span class="at">vehicle.age.f =</span> <span class="fu">as.factor</span>(vehicle.age),</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>                                    <span class="at">prior.claims.f =</span> <span class="fu">as.factor</span>(prior.claims)) <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>yrs.licensed,<span class="sc">-</span>vehicle.age,<span class="sc">-</span>prior.claims)</span></code></pre></div>
<p>Chúng ta ước lượng các mô hình GLM với một biến độc lập, tính toán <span class="math inline">\(AIC\)</span> và <span class="math inline">\(deviance\)</span> và mô tả giá trị <span class="math inline">\(deviance\)</span> và <span class="math inline">\(AIC\)</span> trên một đồ thị rải điểm như sau</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>exposure<span class="ot">&lt;-</span>training.dat<span class="sc">$</span>exposure</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>variable.list<span class="ot">&lt;-</span><span class="fu">names</span>(training.dat)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>remove.list<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;pol.id&quot;</span>,<span class="st">&quot;exposure&quot;</span>,<span class="st">&quot;clm.count&quot;</span>,<span class="st">&quot;clm.incurred&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>variable.list<span class="ot">&lt;-</span>variable.list[<span class="sc">!</span>(variable.list <span class="sc">%in%</span> remove.list)]</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>deviance <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(variable.list))</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>AIC <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(variable.list))</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(variable.list)){</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> variable.list[i]</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  simple.dat<span class="ot">&lt;-</span><span class="fu">select</span>(training.dat,x,clm.count)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  simple.glm<span class="ot">&lt;-</span><span class="fu">glm</span>(clm.count<span class="sc">~</span>., <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> simple.dat,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>                  <span class="at">offset =</span> <span class="fu">log</span>(exposure))</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>  AIC[i]<span class="ot">&lt;-</span>simple.glm<span class="sc">$</span>aic</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  deviance[i]<span class="ot">&lt;-</span>simple.glm<span class="sc">$</span>deviance</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>}</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">variable_names =</span> variable.list, <span class="at">aic =</span> AIC, <span class="at">deviance =</span> deviance)</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>result<span class="sc">%&gt;%</span><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> AIC, <span class="at">y =</span> deviance), <span class="at">shape =</span> <span class="dv">21</span>)<span class="sc">+</span> </span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x =</span> AIC, <span class="at">y =</span> deviance, <span class="at">label =</span> variable.list))<span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;So sánh các mô hình GLM có một biến giải thích (1)&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Đồ thị rải điểm mô tả chỉ tiêu AIC trên trục x và giá trị deviance trên trục y. Các biến giải thích tốt hơn sẽ xuất hiện ở góc dưới bên trái của đồ thị, nơi cả deviance và AIC đều có giá trị nhỏ. Chúng ta thấy các biến <span class="math inline">\(ncd.level\)</span>, <span class="math inline">\(year\)</span> và <span class="math inline">\(yrs.licensed\)</span> là nằm ở góc trái và phía dưới hơn các biến khác. Biến <span class="math inline">\(driver.age\)</span> và <span class="math inline">\(region\)</span> có tác động lên tần suất xảy ra tai nạn nhưng mô hình tuyến tính tổng quát xây dựng trên các biến này lại không có kết quả giống như ta mong muốn. Nguyên nhân là do
- Biến <span class="math inline">\(region\)</span> là biến kiểu rời rạc và có 38 giá trị riêng biệt dẫn đến việc xây dựng mô hình sẽ có quá nhiều tham số.
- Biến <span class="math inline">\(driver.age\)</span> có các giá trị từ 75 tuổi trở lên là có quá ít quan sát và không có tai nạn nào xảy ra.</p>
<p>Đối với các biến kiểu rời rạc trong mô hình tuyến tính tổng quát, kinh nghiệm xây dựng mô hình là kết hợp các nhóm có cùng hệ số ước lượng gần nhau để tạo thành nhóm mới. Điều này giúp mô hình ước lượng có phương sai nhỏ hơn nhưng không làm giảm sai số của mô hình đi quá nhiều. Hình vẽ dưới đây cho biết hệ số ước lượng cho mỗi vùng khác nhau của biến <span class="math inline">\(region\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>simple.dat<span class="ot">&lt;-</span><span class="fu">select</span>(training.dat,region,clm.count)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>simple.glm<span class="ot">&lt;-</span><span class="fu">glm</span>(clm.count<span class="sc">~</span>., <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> simple.dat,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                  <span class="at">offset =</span> <span class="fu">log</span>(exposure))</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">d.name =</span> <span class="fu">names</span>(simple.glm<span class="sc">$</span>coefficients), <span class="at">coef =</span> simple.glm<span class="sc">$</span>coefficients)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>dat1<span class="sc">$</span>d.name[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">&quot;region1&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>dat1<span class="sc">$</span>coef[<span class="dv">2</span><span class="sc">:</span><span class="dv">38</span>]<span class="ot">&lt;-</span>dat1<span class="sc">$</span>coef[<span class="dv">2</span><span class="sc">:</span><span class="dv">38</span>]<span class="sc">+</span>dat1<span class="sc">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">arrange</span>(dat1,<span class="sc">-</span>coef)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>p1<span class="ot">&lt;-</span>dat1<span class="sc">%&gt;%</span><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> coef, <span class="at">y =</span> d.name))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> dat1<span class="sc">$</span>d.name)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Hệ số của biến region trong mô hình GLM&quot;</span>)</span></code></pre></div>
Chúng ta có thể biến đổi biến <span class="math inline">\(region\)</span> bằng cách nhóm các vùng có hệ số ước lượng tương tự nhau vào cùng nhóm để giảm số lượng tham số.
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-19">Table 1.8: </span>Nhóm các vùng theo hệ số ước lượng
</caption>
<thead>
<tr>
<th style="text-align:left;">
Tên biến mới
</th>
<th style="text-align:left;">
Region
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
R1
</td>
<td style="text-align:left;">
7,2
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:left;">
20,22
</td>
</tr>
<tr>
<td style="text-align:left;">
R3
</td>
<td style="text-align:left;">
27,29,14,35
</td>
</tr>
<tr>
<td style="text-align:left;">
R4
</td>
<td style="text-align:left;">
11,37,12,30,28,15,19
</td>
</tr>
<tr>
<td style="text-align:left;">
R5
</td>
<td style="text-align:left;">
4,13,24,3,10,16
</td>
</tr>
<tr>
<td style="text-align:left;">
R6
</td>
<td style="text-align:left;">
1,38,34,31,21,32,25,23
</td>
</tr>
<tr>
<td style="text-align:left;">
R7
</td>
<td style="text-align:left;">
6,33,9,17
</td>
</tr>
<tr>
<td style="text-align:left;">
R8
</td>
<td style="text-align:left;">
8,26
</td>
</tr>
</tbody>
</table>
<p>Biến mới được tạo từ biến <span class="math inline">\(region\)</span> được gọi tên là <span class="math inline">\(region.f\)</span> được thêm vào dữ liệu như sau</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>training.dat<span class="ot">&lt;-</span><span class="fu">mutate</span>(training.dat, <span class="at">region.f =</span> <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">2</span>), <span class="st">&quot;R1&quot;</span>, </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                                                     <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">22</span>), <span class="st">&quot;R2&quot;</span>, </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                                                            <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">27</span>,<span class="dv">29</span>,<span class="dv">14</span>,<span class="dv">35</span>), <span class="st">&quot;R3&quot;</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                                                                   <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">37</span>,<span class="dv">12</span>,<span class="dv">30</span>,<span class="dv">28</span>,<span class="dv">15</span>,<span class="dv">19</span>), <span class="st">&quot;R4&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>                                                                          <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">13</span>,<span class="dv">24</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">16</span>), <span class="st">&quot;R5&quot;</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>                                                                                 <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">38</span>,<span class="dv">34</span>,<span class="dv">31</span>,<span class="dv">21</span>,<span class="dv">32</span>,<span class="dv">25</span>,<span class="dv">23</span>), <span class="st">&quot;R6&quot;</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>                                                                                        <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">33</span>,<span class="dv">9</span>,<span class="dv">17</span>), <span class="st">&quot;R7&quot;</span>,<span class="st">&quot;R8&quot;</span>))))))))</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co"># Thực hiện biến đổi tương tự trên tập xác thực</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>test.dat<span class="ot">&lt;-</span><span class="fu">mutate</span>(test.dat, <span class="at">region.f =</span> <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">2</span>), <span class="st">&quot;R1&quot;</span>, </span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>                                                     <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">22</span>), <span class="st">&quot;R2&quot;</span>, </span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>                                                            <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">27</span>,<span class="dv">29</span>,<span class="dv">14</span>,<span class="dv">35</span>), <span class="st">&quot;R3&quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>                                                                   <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">37</span>,<span class="dv">12</span>,<span class="dv">30</span>,<span class="dv">28</span>,<span class="dv">15</span>,<span class="dv">19</span>), <span class="st">&quot;R4&quot;</span>,</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>                                                                          <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">13</span>,<span class="dv">24</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">16</span>), <span class="st">&quot;R5&quot;</span>,</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>                                                                                 <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">38</span>,<span class="dv">34</span>,<span class="dv">31</span>,<span class="dv">21</span>,<span class="dv">32</span>,<span class="dv">25</span>,<span class="dv">23</span>), <span class="st">&quot;R6&quot;</span>,</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>                                                                                        <span class="fu">ifelse</span>(region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">33</span>,<span class="dv">9</span>,<span class="dv">17</span>), <span class="st">&quot;R7&quot;</span>,<span class="st">&quot;R8&quot;</span>))))))))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Có thể thấy rằng mô hình với biến <span class="math inline">\(region.f\)</span> có chỉ tiêu AIC nhỏ hơn so với <span class="math inline">\(region\)</span> vì số lượng tham số sử dụng chỉ là 8 tham số thay vì 38 tham số như ban đầu. Bạn đọc có thể tiếp tục quá trình phân tích đơn biến như phân tích đối với biến <span class="math inline">\(region\)</span> để có các biến đầu vào tốt hơn trong mô hình nhiều biến.</p>
<p>Với các phân tích đơn biến ở trên, chúng ta có thể kết luận rằng các biến <span class="math inline">\(ncd.levels\)</span>, <span class="math inline">\(year\)</span>, <span class="math inline">\(nb.rb\)</span>, <span class="math inline">\(region.f\)</span>, <span class="math inline">\(yrs.licenced.f\)</span>, <span class="math inline">\(driver.age\)</span> và <span class="math inline">\(prior.claims\)</span> là các biến có ý nghĩa nhất va có ảnh hưởng đến tần suất gây ra tai nạn. Lưu ý rằng biến <span class="math inline">\(year\)</span> không phải là biến liên quan đến đặc điểm của người lái xe hay phương tiện được bảo hiểm. Trong các mô hình tần suất và mức độ nghiêm trọng, biến thời gian thường được gọi là biến điều khiển và luôn có mặt trong mô hình đa biến.</p>
</div>
</div>
<div id="xây-dựng-mô-hình-tuyến-tính-tổng-quát-nhiều-biến" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Xây dựng mô hình tuyến tính tổng quát nhiều biến<a href="#xây-dựng-mô-hình-tuyến-tính-tổng-quát-nhiều-biến" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sau khi đã có ý tưởng tốt hơn về những biến giải thích phù hợp với dữ liệu, chúng ta có thể chuyển sang xây dựng các mô hình kết hợp nhiều hơn một biến giải thích. Về mặt lý thuyết, để tìm ra mô hình đa biến tốt, chúng ta có thể xem xét cả hai mô hình biến và chọn mô hình tốt nhất; sau đó có thể xem xét cả ba mô hình biến và lại chọn mô hình tốt nhất, v.v. Chiến lược này gọi là <span class="math inline">\(forward-stepwise-selection\)</span>. Tuy nhiên với số lượng biến chúng ta hiện có thì chiến lược này không khả thi Một chiến lược khác là xây dựng một mô hình có đầy đủ các biến sau đó lần lượt loại đi các biến không cần thiết. Mặc dù chiến lược này không yêu cầu về mặt tính toán nhưng nhược điểm chính là sự phụ thuộc vào thứ tự chúng ta loại bỏ đi các biến giải thích. Phương pháp khả thi nhất trong trường hợp hày là xây dựng mô hình đa biến được lựa chọn từ một tập hợp con các biến có ý nghĩa trong phân tích một biến sau đó cố gắng thêm các biến khác vào mô hình.</p>
<p>Chúng ta cho mô hình với 7 biến giải thích <span class="math inline">\(ncd.levels\)</span>, <span class="math inline">\(year\)</span>, <span class="math inline">\(nb.rb\)</span>, <span class="math inline">\(region.f\)</span>, <span class="math inline">\(yrs.licenced.f\)</span>, <span class="math inline">\(driver.age\)</span> và <span class="math inline">\(prior.claims.f\)</span> là mô hình cơ sở và sẽ tìm kiếm các biến khác thêm vào mô hình nhằm cải thiện các chỉ tiêu như <span class="math inline">\(deviance\)</span> và <span class="math inline">\(AIC\)</span>.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Đồ thị trên cho thấy các biến có làm tăng chất lượng của mô hình là <span class="math inline">\(body.code\)</span>, <span class="math inline">\(height\)</span>, và <span class="math inline">\(marital.status\)</span>. Cách tốt nhất để đưa thêm biến độc lập vào mô hình cơ sở là thêm lần lượt từng biến vào mô hình sau đó và lặp lại các bước ở trên. Tuy nhiên, để tránh sự phức tạp không cần thiết, chúng ta sẽ đưa đồng thời cả ba biến vào mô hình sau đó thực hiện kiểm định <span class="math inline">\(\chi^2\)</span>: hiệu số giữa <span class="math inline">\(residual\)</span> <span class="math inline">\(deviance\)</span> của mô hình sau khi thêm biến và mô hình cơ sở có phân phối xấp xỉ phân phối <span class="math inline">\(\chi^2\)</span> với bậc tự do <span class="math inline">\(m_2 - m_1\)</span>, với <span class="math inline">\(m_2 - m_1\)</span> là số lượng tham số thêm vào trong mô hình mới. Biến <span class="math inline">\(body.code\)</span> là biến kiểu factor có 8 giá trị riêng biệt, biết <span class="math inline">\(height\)</span> là biến kiểu số, trong khi biến <span class="math inline">\(marital.status\)</span> là biến kiểu factor có 4 giá trị riêng biệt, do đó thêm 3 biến vào mô hình sẽ làm cho số lượng tham số của mô hình tăng lên là <span class="math inline">\((8-1) + 1 + (4-1) = 11\)</span> tham số.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-23">Table 1.9: </span>Thước đo deviance của mô hình cơ sở và mô hình thêm biến
</caption>
<thead>
<tr>
<th style="text-align:left;">
Mô hình
</th>
<th style="text-align:left;">
Residual Deviance
</th>
<th style="text-align:left;">
Deviance giảm
</th>
<th style="text-align:left;">
Bậc tự do
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mô hình cơ sở
</td>
<td style="text-align:left;">
10884.01
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Mô hình thêm biến
</td>
<td style="text-align:left;">
10829.02
</td>
<td style="text-align:left;">
54.99
</td>
<td style="text-align:left;">
11
</td>
</tr>
</tbody>
</table>
<p>Giá trị deviance giảm 54.99 sau khi thêm 11 tham số vào mô hình. Lưu ý rằng giá trị phân vị ngưỡng 99.99% của phân phối <span class="math inline">\(\chi^2(11)\)</span> là 37.37, nhỏ hơn 54.99, nên chúng ta có thể kết luận rằng việc thêm 3 biến <span class="math inline">\(body.code\)</span>, <span class="math inline">\(height\)</span>, và <span class="math inline">\(marital.status\)</span> là có ý nghĩa thống kê. Bạn đọc có thể lặp lại các bước ở trên để tìm được thêm các biến có ý nghĩa đưa vào mô hình giải thích tần suất.</p>
</div>
<div id="mô-hình-tuyến-tính-tổng-quát-cho-biến-mức-độ-nghiêm-trọng." class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Mô hình tuyến tính tổng quát cho biến mức độ nghiêm trọng.<a href="#mô-hình-tuyến-tính-tổng-quát-cho-biến-mức-độ-nghiêm-trọng." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Xây dựng mô hình cho mức độ nghiêm trọng khó khăn hơn xây dựng mô hình cho tần suất vì thứ nhất, có ít dữ liệu hơn và thứ hai, các giá trị quan sát được thường biến động lớn. Thông thường, phần lớn các hợp đồng có yêu cầu bồi thường có mức độ nghiêm trọng nhỏ và trong khi một số ít hợp đồng có mức độ nghiêm trọng rất lớn. Điều này thường dẫn đến phân phối của mức độ nghiêm trọng bị lệch phải, như được thể hiện trong biểu đồ ở dưới. Bạn đọc có thể thấy rằng gần như tất cả các quan sát đều tập trung ở phía bên trái của biểu đồ. Có rất ít giá trị lớn hơn 6.000; trên thực tế, chỉ có 11 hợp đồng có yêu cầu bồi thường có mức độ nghiêm trọng lớn hơn 6000 trong tổng số 2209 quan sát có yêu cầu bồi thường trong tập dữ liệu huấn luyện.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>Tương tự như khi xây dựng mô hình cho biến tần suất, chúng ta bắt đầu xây dựng mô hình cho biến mức độ nghiêm trọng bằng mô hình không có biến phụ thuộc.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">glm</span>(clm.serverity <span class="sc">~</span><span class="dv">1</span>, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> training.dat, <span class="at">weights =</span> clm.count , <span class="at">subset =</span> clm.count<span class="sc">&gt;</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = clm.serverity ~ 1, family = Gamma(link = &quot;log&quot;), 
##     data = training.dat, weights = clm.count, subset = clm.count &gt; 
##         0)
## 
## Coefficients:
## (Intercept)  
##       6.685  
## 
## Degrees of Freedom: 2208 Total (i.e. Null);  2208 Residual
## Null Deviance:       4626 
## Residual Deviance: 4626  AIC: 36280</code></pre>
<p>Mô hình không có biến giải thích có hệ số chặn là 6.685, nghĩa là giá trị trung bình của biến mức độ nghiêm trọng là <span class="math inline">\(e^{6.685} = 800.31\)</span> tương tự như giá trị trung bình đã tính toán ở phần khai phá dữ liệu.</p>
<p>Biến <span class="math inline">\(year\)</span> kiểm soát tác động của thời gian lên mức độ nghiêm trọng, do đó chúng ta sẽ đưa biến này vào tất cả các mô hình cho mức độ nghiêm trọng. Các bước để xây dựng mô hình giống như khi chúng ta xây dựng mô hình cho tần suất: chúng ta cần tìm kiếm các biến giải thích (ngoài biến <span class="math inline">\(year\)</span>) có khả năng dự đoán mức độ nghiêm trọng của các yêu cầu bồi thường. Quá trình này tương tự như phần trước nên chúng tôi sẽ cố gắng trình bày ngắn gọn nhất có thể.</p>
<div id="mô-hình-đơn-biến-cho-mức-độ-nghiêm-trọng" class="section level3 hasAnchor" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Mô hình đơn biến cho mức độ nghiêm trọng<a href="#mô-hình-đơn-biến-cho-mức-độ-nghiêm-trọng" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mô hình đơn biến được hiểu là mô hình bao gồm hệ số chặn, biến điều khiển <span class="math inline">\(year\)</span> và một biến giải thích. Tương tự như khi xây dựng mô hình cho biến tần suất, chúng ta tính toán <span class="math inline">\(deviance\)</span> và chỉ tiêu <span class="math inline">\(AIC\)</span> cho các mô hình và biểu diễn kết quả trên một đồ thị rải điểm</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>variable.list<span class="ot">&lt;-</span><span class="fu">names</span>(training.dat)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>remove.list<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;pol.id&quot;</span>,<span class="st">&quot;exposure&quot;</span>,<span class="st">&quot;clm.count&quot;</span>,<span class="st">&quot;clm.incurred&quot;</span>,<span class="st">&quot;clm.serverity&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;region&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>variable.list<span class="ot">&lt;-</span>variable.list[<span class="sc">!</span>(variable.list <span class="sc">%in%</span> remove.list)]</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">length</span>(variable.list)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>v.clm.count<span class="ot">&lt;-</span>training.dat<span class="sc">$</span>clm.count</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>deviance <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>AIC <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> variable.list[i]</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  simple.dat<span class="ot">&lt;-</span><span class="fu">select</span>(training.dat,year,x,clm.serverity)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>  simple.glm<span class="ot">&lt;-</span><span class="fu">glm</span>(clm.serverity<span class="sc">~</span>., <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> simple.dat, <span class="at">weights =</span> v.clm.count, <span class="at">subset =</span> v.clm.count<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  AIC[i]<span class="ot">&lt;-</span>simple.glm<span class="sc">$</span>aic</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>  deviance[i]<span class="ot">&lt;-</span>simple.glm<span class="sc">$</span>deviance</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>}</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>simple.dat<span class="ot">&lt;-</span><span class="fu">select</span>(training.dat,year,clm.serverity)</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>simple.glm<span class="ot">&lt;-</span><span class="fu">glm</span>(clm.serverity<span class="sc">~</span>., <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> simple.dat, <span class="at">weights =</span> v.clm.count, <span class="at">subset =</span> v.clm.count<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>AIC[p<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span>simple.glm<span class="sc">$</span>aic</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>deviance[p<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span>simple.glm<span class="sc">$</span>deviance</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">variable_names =</span> <span class="fu">c</span>(variable.list,<span class="st">&quot;Null&quot;</span>), <span class="at">aic =</span> AIC, <span class="at">deviance =</span> deviance, <span class="at">last.col =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,p),<span class="dv">1</span>)))</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>result<span class="sc">%&gt;%</span><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> AIC, <span class="at">y =</span> deviance,, <span class="at">size =</span> last.col, <span class="at">fill =</span> last.col), <span class="at">shape =</span> <span class="dv">21</span>)<span class="sc">+</span> </span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x =</span> AIC, <span class="at">y =</span> deviance, <span class="at">label =</span> variable_names))<span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mô hình GLM đơn biến cho mức độ nghiêm trọng&quot;</span>)<span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Mô hình “Null” là mô hình chỉ bao gồm biến <span class="math inline">\(year\)</span> và hệ số chặn. Có thể thấy rằng việc thêm biến giải thích vào mô hình sẽ làm cho <span class="math inline">\(deviance\)</span> giảm, nhưng chưa chắc chỉ số AIC sẽ giảm vì AIC tính đến số lượng tham số trong mô hình. Một số biến có làm giảm AIC của mô hình bao gồm có <span class="math inline">\(ncd.level\)</span>, <span class="math inline">\(nb.rb\)</span>, <span class="math inline">\(marital.status\)</span>, <span class="math inline">\(yrs.licensed.num\)</span>, <span class="math inline">\(driver.gender\)</span>.</p>
</div>
<div id="mô-hình-nhiều-biến-cho-mức-độ-nghiêm-trọng" class="section level3 hasAnchor" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Mô hình nhiều biến cho mức độ nghiêm trọng<a href="#mô-hình-nhiều-biến-cho-mức-độ-nghiêm-trọng" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chúng ta xây dựng mô hình đa biến bao gồm 5 biến kể trên sau đó tìm kiếm thêm các biến khác.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>glm1<span class="ot">&lt;-</span><span class="fu">glm</span>(clm.serverity <span class="sc">~</span> year <span class="sc">+</span> ncd.level<span class="sc">+</span> nb.rb <span class="sc">+</span> marital.status <span class="sc">+</span> yrs.licensed.num <span class="sc">+</span> driver.gender, </span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>         <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> training.dat, <span class="at">weights =</span> clm.count, <span class="at">subset =</span> clm.count<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">summary</span>(glm1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = clm.serverity ~ year + ncd.level + nb.rb + marital.status + 
##     yrs.licensed.num + driver.gender, family = Gamma(link = &quot;log&quot;), 
##     data = training.dat, weights = clm.count, subset = clm.count &gt; 
##         0)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.9662  -1.5961  -0.6651   0.3050   3.7805  
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            6.628362   0.227028  29.196   &lt;2e-16 ***
## year2011              -0.232547   0.106311  -2.187   0.0288 *  
## year2012               0.128161   0.092530   1.385   0.1662    
## year2013               0.271938   0.094109   2.890   0.0039 ** 
## ncd.level2            -0.237103   0.268439  -0.883   0.3772    
## ncd.level3             0.007723   0.073769   0.105   0.9166    
## ncd.level4            -0.123855   0.102547  -1.208   0.2273    
## ncd.level5            -0.215120   0.125589  -1.713   0.0869 .  
## ncd.level6            -0.196879   0.114226  -1.724   0.0849 .  
## nb.rbRB               -0.086679   0.075003  -1.156   0.2479    
## marital.statusMarried  0.102740   0.204406   0.503   0.6153    
## marital.statusSingle   0.204259   0.241585   0.845   0.3979    
## marital.statusWidow    0.428399   0.283793   1.510   0.1313    
## yrs.licensed.num       0.002306   0.021181   0.109   0.9133    
## driver.genderMale     -0.128635   0.086560  -1.486   0.1374    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 1.854572)
## 
##     Null deviance: 4626.1  on 2208  degrees of freedom
## Residual deviance: 4526.6  on 2194  degrees of freedom
## AIC: 36243
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>Có thể thấy rằng biến <span class="math inline">\(yrs.licensed.num\)</span> có thể làm giảm AIC trong mô hình đơn biến nhưng trong mô hình đa biến biến này lại không có ý nghĩa. Chúng ta sẽ loại bỏ biến <span class="math inline">\(yrs.licensed.num\)</span> ra khỏi mô hình đa biến. Các biến khác đều là các biến dạng factor và không phải tất cả các giá trị của biến factor đều có ý nghĩa thống kê. Chẳng hạn như <span class="math inline">\(ncd.level3\)</span> gần như không có khác biệt với <span class="math inline">\(ncd.level1\)</span>. Hoặc các giá trị <span class="math inline">\(Divorced\)</span> và <span class="math inline">\(Married\)</span> của biến <span class="math inline">\(marital.status\)</span> cũng không có sự khác biệt. Điều này gợi ý cho bạn đọc về việc tạo các biến <span class="math inline">\(ncd.level\)</span> và <span class="math inline">\(marital.status\)</span> mới có ý nghĩa thống kê hơn. Trong phần này của cuốn sách, để tránh sự phức tạp không cần thiết, chúng tôi sẽ giữ nguyên các biến <span class="math inline">\(ncd.level\)</span> và <span class="math inline">\(marital.status\)</span> ở trạng thái hiện tại.</p>
<p>Chúng ta coi mô hình bao gồm 5 biến giải thích <span class="math inline">\(year\)</span>, <span class="math inline">\(ncd.level\)</span>, <span class="math inline">\(nb.rb\)</span>, <span class="math inline">\(marital.status\)</span>, và <span class="math inline">\(driver.gender\)</span> là mô hình cơ sở để tìm kiếm thêm các biến giải thích khác.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Đồ thị trên gợi ý cho chúng ta biết biến <span class="math inline">\(vehicle.age.num\)</span> là một biến giải thích tốt có làm giảm chỉ tiêu AIC. Chúng ta thực hiện kiểm định <span class="math inline">\(\chi^2\)</span> để kiểm tra xem việc thêm biến vào có ý nghĩa thống kê hay không</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-29">Table 1.10: </span>Thước đo deviance của mô hình cơ sở và mô hình thêm biến
</caption>
<thead>
<tr>
<th style="text-align:left;">
Mô hình
</th>
<th style="text-align:left;">
Residual Deviance
</th>
<th style="text-align:left;">
Deviance giảm
</th>
<th style="text-align:left;">
Bậc tự do
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mô hình cơ sở
</td>
<td style="text-align:left;">
4526.664
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Mô hình thêm biến
</td>
<td style="text-align:left;">
4519.061
</td>
<td style="text-align:left;">
7.6
</td>
<td style="text-align:left;">
1
</td>
</tr>
</tbody>
</table>
<p>Giá trị deviance giảm 7.6 sau khi thêm 1 tham số vào mô hình. Đây là giá trị phân vị ngưỡng 99.4% của phân phối <span class="math inline">\(\chi^2(1)\)</span> nên chúng ta có thể kết luận rằng việc thêm biến <span class="math inline">\(vehicle.age.num\)</span> là có ý nghĩa thống kê. Bạn đọc có thể lặp lại các bước ở trên để tìm được thêm các biến có ý nghĩa đưa vào mô hình giải thích mức độ nghiêm trọng.</p>
</div>
</div>
<div id="xác-định-phí-bảo-hiểm-thuần-và-xác-thực-mô-hình" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Xác định phí bảo hiểm thuần và xác thực mô hình<a href="#xác-định-phí-bảo-hiểm-thuần-và-xác-thực-mô-hình" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Trong phần này, chúng ta kết hợp các mô hình tần suất và mức độ nghiêm trọng để xác định mức phí bảo hiểm thuần. Công thức xác định phí bảo hiểm thuần chỉ đơn giản là
<span class="math display">\[\begin{align}
\textit{Phí bảo hiểm thuần} = \textit{Tần suất} \times \textit{Mức độ nghiêm trọng}
\end{align}\]</span></p>
<p>Chúng ta sử dụng mô hình tần suất và mô hình mức độ nghiêm trọng với các biến được xác định trong phần trước. Danh sách các biến được liệt kê trong bảng dưới đây.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-30">Table 1.11: </span>Các biến sử dụng trong xác định phí bảo hiểm thuần
</caption>
<thead>
<tr>
<th style="text-align:left;">
Mô hình
</th>
<th style="text-align:left;">
Danh sách biến
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tần suất
</td>
<td style="text-align:left;">
year, ncd.level, nb.rb, yrs.licensed.f, region.f, driver.age, prior.claims.f,body.code, height, marital.status
</td>
</tr>
<tr>
<td style="text-align:left;">
Mức độ nghiêm trọng
</td>
<td style="text-align:left;">
year, ncd.level, nb.rb, marital.status, driver.gender, vehicle.age.num
</td>
</tr>
</tbody>
</table>
<p>Chúng ta thêm biến tần suất trung bình (<span class="math inline">\(E.fre\)</span>), mức độ nghiêm trọng trung bình (<span class="math inline">\(E.ser\)</span>) và phí thuần (<span class="math inline">\(Net.prem\)</span>) vào dữ liệu huấn luyện mô hình.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>glm.fre<span class="ot">&lt;-</span><span class="fu">glm</span>(clm.count<span class="sc">~</span> year <span class="sc">+</span> ncd.level<span class="sc">+</span> nb.rb<span class="sc">+</span> yrs.licensed.f <span class="sc">+</span> region.f <span class="sc">+</span> driver.age <span class="sc">+</span> </span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>               prior.claims.f <span class="sc">+</span> marital.status <span class="sc">+</span>  body.code<span class="sc">+</span> height, </span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> training.dat,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                <span class="at">offset =</span> <span class="fu">log</span>(exposure))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>glm.ser<span class="ot">&lt;-</span><span class="fu">glm</span>(clm.serverity <span class="sc">~</span> year <span class="sc">+</span> ncd.level<span class="sc">+</span> nb.rb <span class="sc">+</span> marital.status <span class="sc">+</span> driver.gender <span class="sc">+</span> vehicle.age.num, </span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>         <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> training.dat, <span class="at">weights =</span> clm.count, <span class="at">subset =</span> clm.count<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="do">## Tính toán expected frequency và expected severity</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>training.dat<span class="ot">&lt;-</span><span class="fu">mutate</span>(training.dat, <span class="at">E.fre =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(glm.fre, training.dat)),</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>                     <span class="at">E.ser =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(glm.ser, training.dat)),</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>                     <span class="at">Net.prem =</span> E.fre<span class="sc">*</span>E.ser)</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co"># Dự đoán expected frequency và expected severity trên test</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>test.dat<span class="ot">&lt;-</span><span class="fu">mutate</span>(test.dat, <span class="at">E.fre =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(glm.fre, test.dat)),</span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>                     <span class="at">E.ser =</span> <span class="fu">exp</span>(<span class="fu">predict</span>(glm.ser, test.dat)),</span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>                 <span class="at">Net.prem =</span> E.fre <span class="sc">*</span> E.ser)</span></code></pre></div>
<p>Chúng ta thực hiện so sánh giữa tổng phí thuần của tất cả các hợp đồng với tổng số tiền thực trả cho các hợp đồng trong tập dữ liệu huấn luyện. Không có gì ngạc nhiên khi tổng tần suất trung bình bằng tổng số yêu cầu bổi thường và tổng phí bảo hiểm thuần xấp xỉ tổng số tiền yêu cầu bồi thường thực tế do mô hình được xây dựng trên tập huấn luyện.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-32">Table 1.12: </span>Giá trị thực tế và dự đoán trên dữ liệu huấn luyên mô hình
</caption>
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
Thực tế
</th>
<th style="text-align:center;">
Dự đoán
</th>
<th style="text-align:center;">
Tỷ lệ dự đoán/thực tế
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Tần suất yêu cầu bồi thường
</td>
<td style="text-align:center;">
2382
</td>
<td style="text-align:center;">
2382
</td>
<td style="text-align:center;">
100%
</td>
</tr>
<tr>
<td style="text-align:center;">
Tổng chi phí bồi thường
</td>
<td style="text-align:center;">
1906958
</td>
<td style="text-align:center;">
1914962
</td>
<td style="text-align:center;">
100.42%
</td>
</tr>
</tbody>
</table>
<p>Thước đo quan trọng nhất về hiệu quả của mô hình là khả năng dự đoán của mô hình trên tập dữ liệu được sử dụng để kiểm tra (<span class="math inline">\(test.dat\)</span>). Tổng số lượng yêu cầu bồi thường và tổng chi phí bồi thường được dự đoán bằng mô hình tần suất - mức độ nghiêm trọng được so sánh với giá trị thực tế như ở bảng dưới đây</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-33">Table 1.13: </span>Giá trị thực tế và dự đoán trên dữ liệu huấn luyên mô hình
</caption>
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
Thực tế
</th>
<th style="text-align:center;">
Dự đoán
</th>
<th style="text-align:center;">
Tỷ lệ dự đoán/thực tế
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Tần suất yêu cầu bồi thường
</td>
<td style="text-align:center;">
1049.0
</td>
<td style="text-align:center;">
1004.69
</td>
<td style="text-align:center;">
95.78%
</td>
</tr>
<tr>
<td style="text-align:center;">
Tổng chi phí bồi thường
</td>
<td style="text-align:center;">
804228.5
</td>
<td style="text-align:center;">
807962.62
</td>
<td style="text-align:center;">
100.46%
</td>
</tr>
</tbody>
</table>
<p>Bạn đọc có thể thấy rằng trên dữ liệu ngoài mẫu, tổng số lượng yêu cầu bồi thường dự đoán bằng 95.78% tổng số lượng yêu cầu bồi thường thực tế, trong khi tổng số tiền yêu cầu bồi thường dự đoán bằng 100.46% tổng số tiền yêu cầu bồi thường thực tế. Có thể thấy rằng khả năng dự đoán ngoài mẫu của mô hình về cơ bản không thể giống như dự đoán trong mẫu, tuy nhiên các tỷ lệ 95.78% và 100.46% là vượt quá mức độ kỳ vọng vì tổng số lượng hợp đồng ngoài mẫu là 12228 hợp đồng.</p>
<p>Ngoài phương pháp xác thực bằng dữ liệu ngoài mẫu, bạn đọc cũng có thể sử dụng xác thực chéo để đánh giá khả năng dự đoán của mô hình. Chúng ta sẽ chia dữ liệu ban đầu thành 5 phần (một cách ngẫu nhiên), tạm gọi là các phần 1, 2, 3, 4 và 5. Mỗi lần xây dựng mô hình, chúng ta sẽ lấy 1 phần làm dữ liệu ngoài mẫu và sử dụng 4 phần còn lại để xây dựng mô hình. Một mô hình ổn định là mô hình có khả năng dự đoán trên các tập ngoài mẫu không bị biến động quá nhiều.</p>
<!-- # REFERENCE -->
<!-- ### Source from thesis -->
<!-- **1.** Chen, Chun-houh, Wolfgang Karl Härdle, and Antony Unwin, eds (2007). *Handbook of data visualization.* \ -->
<!-- **2.** Aparicio, Manuela, and Carlos J. Costa. (2015). *Data visualization - Communication design quarterly review.* \ -->
<!-- **3.** Hadley Wickham. (2010). *A Layered Grammar of Graphics.* \ -->
<!-- ### Souce from website -->
<!-- **4.** [https://www.tableau.com/learn/articles/data-visualization](https://www.tableau.com/learn/articles/data-visualization) \ -->
<!-- **5.** [https://www.r-graph-gallery.com/ggplot2-package.html](https://www.r-graph-gallery.com/ggplot2-package.html) \ -->
<!-- **6.** [http://r-statistics.co/ggplot2-Tutorial-With-R.html](http://r-statistics.co/ggplot2-Tutorial-With-R.html) \ -->
<!-- **7.** [https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf](https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf) \ -->
<!-- **8.** [https://www.kaggle.com/](https://www.kaggle.com/) \ -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
